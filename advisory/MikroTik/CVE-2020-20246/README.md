### CVE-2020-20246

#### Description

The `mactel` process suffers from a memory corruption vulnerability. By sending a crafted packet, an authenticated remote user can crash the `mactel` process due to NULL pointer dereference.

Against stable `6.47`, the poc resulted in the following crash dump.

```shell
# cat /rw/logs/backtrace.log
2020.06.22-20:25:36.17@0: 
2020.06.22-20:25:36.17@0: 
2020.06.22-20:25:36.17@0: /nova/bin/mactel
2020.06.22-20:25:36.17@0: --- signal=11 --------------------------------------------
2020.06.22-20:25:36.17@0: 
2020.06.22-20:25:36.17@0: eip=0x0804ddc7 eflags=0x00010202
2020.06.22-20:25:36.17@0: edi=0x08055740 esi=0x7fe78144 ebp=0x7fe780c8 esp=0x7fe78090
2020.06.22-20:25:36.17@0: eax=0x00000000 ebx=0x776b9b40 ecx=0x0000000b edx=0xffffffff
2020.06.22-20:25:36.17@0: 
2020.06.22-20:25:36.17@0: maps:
2020.06.22-20:25:36.17@0: 08048000-08051000 r-xp 00000000 00:0c 1041       /nova/bin/mactel
2020.06.22-20:25:36.17@0: 7762c000-77661000 r-xp 00000000 00:0c 966        /lib/libuClibc-0.9.33.2.so
2020.06.22-20:25:36.17@0: 77665000-7767f000 r-xp 00000000 00:0c 962        /lib/libgcc_s.so.1
2020.06.22-20:25:36.17@0: 77680000-7768f000 r-xp 00000000 00:0c 945        /lib/libuc++.so
2020.06.22-20:25:36.17@0: 77690000-776ad000 r-xp 00000000 00:0c 948        /lib/libucrypto.so
2020.06.22-20:25:36.17@0: 776ae000-776af000 r-xp 00000000 00:0c 967        /lib/libutil-0.9.33.2.so
2020.06.22-20:25:36.17@0: 776b1000-776b9000 r-xp 00000000 00:0c 951        /lib/libubox.so
2020.06.22-20:25:36.17@0: 776ba000-77706000 r-xp 00000000 00:0c 947        /lib/libumsg.so
2020.06.22-20:25:36.17@0: 7770c000-77713000 r-xp 00000000 00:0c 960        /lib/ld-uClibc-0.9.33.2.so
2020.06.22-20:25:36.17@0: 
2020.06.22-20:25:36.17@0: stack: 0x7fe79000 - 0x7fe78090 
2020.06.22-20:25:36.17@0: 44 81 e7 7f 01 00 00 00 ff ff ff ff 1f d0 04 08 58 57 05 08 28 b0 70 77 01 00 00 00 00 00 00 00 
2020.06.22-20:25:36.17@0: 1c 85 e7 7f 04 1d 05 08 02 db 70 77 40 9b 6b 77 40 57 05 08 44 81 e7 7f f8 80 e7 7f 7c 4a 6b 77 
2020.06.22-20:25:36.17@0: 
2020.06.22-20:25:36.17@0: code: 0x804ddc7
2020.06.22-20:25:36.17@0: 8b 50 2f 89 55 da 66 8b 40 33 66 89 45 de 83 c4
```

#### Affected Version

This vulnerability was initially found in stable  `6.46.3`, and it seems that the latest stable version `7.4` still suffers from this vulnerability.

#### Timeline

+ 2020/03/06 - reported the vulnerability to the vendor
+ 2020/03/09 - vendor confirmed the vulnerability
+ 2021/05/04 - CVE was assigned


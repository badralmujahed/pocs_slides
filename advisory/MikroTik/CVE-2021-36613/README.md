### CVE-2021-36613

#### Description

The `ptp` process suffers from a memory corruption vulnerability. By sending a crafted packet, an authenticated remote user can crash the `ptp` process due to NULL pointer dereference.

Against stable `6.48.1`, the poc resulted in the following crash dump.

```shell
# cat /rw/logs/backtrace.log
2021.02.08-12:13:09.33@0: 
2021.02.08-12:13:09.33@0: /nova/bin/ptp
2021.02.08-12:13:09.33@0: --- signal=11 --------------------------------------------
2021.02.08-12:13:09.33@0: 
2021.02.08-12:13:09.33@0: eip=0x08050abb eflags=0x00010202
2021.02.08-12:13:09.33@0: edi=0x7fd5ee94 esi=0x0805be48 ebp=0x7fd5ee18 esp=0x7fd5ee18
2021.02.08-12:13:09.33@0: eax=0x00000000 ebx=0x776f5b40 ecx=0x0805c6a8 edx=0x00000001
2021.02.08-12:13:09.33@0: 
2021.02.08-12:13:09.33@0: maps:
2021.02.08-12:13:09.33@0: 08048000-08058000 r-xp 00000000 00:0c 1067       /nova/bin/ptp
2021.02.08-12:13:09.33@0: 7767d000-776b2000 r-xp 00000000 00:0c 966        /lib/libuClibc-0.9.33.2.so
2021.02.08-12:13:09.33@0: 776b6000-776d0000 r-xp 00000000 00:0c 962        /lib/libgcc_s.so.1
2021.02.08-12:13:09.33@0: 776d1000-776e0000 r-xp 00000000 00:0c 945        /lib/libuc++.so
2021.02.08-12:13:09.33@0: 776e1000-776eb000 r-xp 00000000 00:0c 963        /lib/libm-0.9.33.2.so
2021.02.08-12:13:09.33@0: 776ed000-776f5000 r-xp 00000000 00:0c 951        /lib/libubox.so
2021.02.08-12:13:09.33@0: 776f6000-77742000 r-xp 00000000 00:0c 947        /lib/libumsg.so
2021.02.08-12:13:09.33@0: 77748000-7774f000 r-xp 00000000 00:0c 960        /lib/ld-uClibc-0.9.33.2.so
2021.02.08-12:13:09.33@0: 
2021.02.08-12:13:09.33@0: stack: 0x7fd5f000 - 0x7fd5ee18 
2021.02.08-12:13:09.33@0: 48 ee d5 7f 7c 0a 6f 77 48 be 05 08 94 ee d5 7f 05 00 00 00 86 3c 71 77 f8 ef d5 7f 0c 00 fe 08 
2021.02.08-12:13:09.33@0: 58 ee d5 7f 40 5b 6f 77 a0 f1 d5 7f 94 ee d5 7f b8 ee d5 7f 16 41 6f 77 94 ee d5 7f a0 f1 d5 7f 
2021.02.08-12:13:09.33@0: 
2021.02.08-12:13:09.33@0: code: 0x8050abb
2021.02.08-12:13:09.33@0: 8b 10 89 45 08 8b 42 18 5d ff e0 55 89 e5 31 c0
```

#### Affected Version

This vulnerability was initially found in stable  `6.48.1`, and was fixed in stable `6.48.2`.

#### Timeline

+ 2021/03/01 - reported the vulnerability to the vendor
+ 2021/03/18 - the vendor reproduced and confirmed the vulnerability
+ 2021/06/01 - the vendor responded that it was fixed in stable `6.48.2`
+ 2022/05/12 - CVE was assigned  


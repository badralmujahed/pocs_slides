### CVE-2020-20236

#### Description

The `sniffer` process suffers from a memory corruption vulnerability. By sending a crafted packet, an authenticated remote user can crash the `sniffer` process due to invalid memory access.

Against stable `6.46.5`, the poc resulted in the following crash dump.

```shell
# cat /rw/logs/backtrace.log 
2020.06.19-16:58:33.42@0: 
2020.06.19-16:58:33.42@0: 
2020.06.19-16:58:33.42@0: /nova/bin/sniffer
2020.06.19-16:58:33.42@0: --- signal=11 --------------------------------------------
2020.06.19-16:58:33.42@0: 
2020.06.19-16:58:33.42@0: eip=0x08050dac eflags=0x00010202
2020.06.19-16:58:33.42@0: edi=0x08057a24 esi=0x00000001 ebp=0x7f8df428 esp=0x7f8df3e0
2020.06.19-16:58:33.42@0: eax=0x08073714 ebx=0x08073710 ecx=0x08073704 edx=0x08073714
2020.06.19-16:58:33.42@0: 
2020.06.19-16:58:33.42@0: maps:
2020.06.19-16:58:33.42@0: 08048000-08056000 r-xp 00000000 00:0c 1034       /nova/bin/sniffer
2020.06.19-16:58:33.42@0: 77730000-77765000 r-xp 00000000 00:0c 964        /lib/libuClibc-0.9.33.2.so
2020.06.19-16:58:33.42@0: 77769000-77783000 r-xp 00000000 00:0c 960        /lib/libgcc_s.so.1
2020.06.19-16:58:33.42@0: 77784000-77793000 r-xp 00000000 00:0c 944        /lib/libuc++.so
2020.06.19-16:58:33.42@0: 77794000-7779c000 r-xp 00000000 00:0c 950        /lib/libubox.so
2020.06.19-16:58:33.42@0: 7779d000-777e9000 r-xp 00000000 00:0c 946        /lib/libumsg.so
2020.06.19-16:58:33.43@0: 777ef000-777f6000 r-xp 00000000 00:0c 958        /lib/ld-uClibc-0.9.33.2.so
2020.06.19-16:58:33.43@0: 
2020.06.19-16:58:33.43@0: stack: 0x7f8e0000 - 0x7f8df3e0 
2020.06.19-16:58:33.43@0: 3c ab 05 08 04 00 fe 08 e0 0f 00 00 14 37 07 08 24 7a 05 08 00 00 00 00 18 f4 8d 7f 04 7a 05 08 
2020.06.19-16:58:33.43@0: 08 00 00 00 24 7a 05 08 04 00 00 00 00 00 00 00 70 4a 7a 77 e4 9a 7e 77 38 f4 8d 7f e4 9a 7e 77 
2020.06.19-16:58:33.43@0: 
2020.06.19-16:58:33.43@0: code: 0x8050dac
2020.06.19-16:58:33.43@0: 8b 43 04 83 e0 fc 85 c0 74 1c 8b 4b 14 39 34 08
```

#### Affected Version

This vulnerability was initially found in long-term  `6.46.3`, and it seems that the latest version stable `6.48.2` still suffers from this vulnerability.

#### Timeline

+ 2020/02/26 - report the vulnerability to the vendor
+ 2020/02/27 - vendor confirms the vulnerability and will work on a fix
+ 2021/05/04 - CVE is assigned


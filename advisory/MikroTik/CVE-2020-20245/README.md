### CVE-2020-20245

#### Description

The `log` process suffers from a memory corruption vulnerability. By sending a crafted packet, an authenticated remote user can crash the `log` process due to invalid memory access.

Against stable `6.47`, the poc resulted in the following crash dump.

```shell
# cat /rw/logs/backtrace.log 
2020.06.22-20:13:36.29@0: 
2020.06.22-20:13:36.29@0: 
2020.06.22-20:13:36.62@0: /nova/bin/log
2020.06.22-20:13:36.62@0: --- signal=11 --------------------------------------------
2020.06.22-20:13:36.62@0: 
2020.06.22-20:13:36.62@0: eip=0x77709d2e eflags=0x00010202
2020.06.22-20:13:36.62@0: edi=0x0000004b esi=0x77718f00 ebp=0x7fec6858 esp=0x7fec6818
2020.06.22-20:13:36.62@0: eax=0x00000031 ebx=0x77717000 ecx=0x777171e8 edx=0x00000006
2020.06.22-20:13:36.62@0: 
2020.06.22-20:13:36.62@0: maps:
2020.06.22-20:13:36.62@0: 08048000-08058000 r-xp 00000000 00:0c 1005       /nova/bin/log
2020.06.22-20:13:36.62@0: 776e1000-77716000 r-xp 00000000 00:0c 966        /lib/libuClibc-0.9.33.2.so
2020.06.22-20:13:36.62@0: 7771a000-77734000 r-xp 00000000 00:0c 962        /lib/libgcc_s.so.1
2020.06.22-20:13:36.62@0: 77735000-77744000 r-xp 00000000 00:0c 945        /lib/libuc++.so
2020.06.22-20:13:36.62@0: 77745000-77791000 r-xp 00000000 00:0c 947        /lib/libumsg.so
2020.06.22-20:13:36.62@0: 77797000-7779e000 r-xp 00000000 00:0c 960        /lib/ld-uClibc-0.9.33.2.so
2020.06.22-20:13:36.62@0: 
2020.06.22-20:13:36.62@0: stack: 0x7fec7000 - 0x7fec6818 
2020.06.22-20:13:36.62@0: 48 68 ec 7f 7b ce 73 77 00 00 00 00 10 00 00 00 00 00 00 00 00 00 00 00 68 68 ec 7f 21 ac 70 77 
2020.06.22-20:13:36.62@0: 40 00 00 00 1b fb 70 77 e8 71 71 77 c0 28 06 08 88 68 ec 7f ec 44 74 77 e4 29 06 08 40 69 ec 7f 
2020.06.22-20:13:36.62@0: 
2020.06.22-20:13:36.62@0: code: 0x77709d2e
2020.06.22-20:13:36.62@0: 8b 48 08 89 4c 96 04 e9 93 05 00 00 81 7d e0 ff 
```

#### Affected Version

This vulnerability was initially found in stable  `6.46.3`, and it seems that the latest stable version `6.48.2` still suffers from this vulnerability.

#### Timeline

+ 2020/03/06 - report the vulnerability to the vendor
+ 2020/03/09 - vendor confirms the vulnerability
+ 2021/05/04 - CVE is assigned